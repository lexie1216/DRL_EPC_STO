# DRL-based Epidemic Control Considering ST-Orderliness


[//]: # (## Contents)

[//]: # ()
[//]: # (- [Introduction]&#40;#Introduction&#41;)

[//]: # (- [Usages]&#40;#Usages&#41;)


## Introduction

A deep-reinforcement-learning-based (DRL) model to optimize the epidemic control strategies with a focus of considering the coordination of interventions in both spatial and temporal dimensions. 


## Usages

[//]: # ()
[//]: # (train the RL agent considering st-order-adj from initial)

[//]: # ()
[//]: # (```shell)

[//]: # (python main.py --experiment_idx 1 --load_model False)

[//]: # (```)

[//]: # (train the RL agent considering no-order from a ckpt)

[//]: # (```shell)

[//]: # (python main.py --experiment_idx 4 --load_model True --model_idx 100 --lr_a 1e-5  --lr_c 1e-5)

[//]: # (```)

The values of "experiment_idx" and their corresponding experiments are as follows:  
  
- `4` corresponds to "basic"  
- `2` corresponds to "t-order"  
- `3`, `5`, `-1` correspond to "s-order-adj", "s-order-mob", "s-order-adm", respectively  
- `1`, `6`, `-2` correspond to "st-order-adj", "st-order-mob", "st-order-adm", respectively


[//]: # (To test a trained model, follow these steps in the main.py file:)
[//]: # (To test a trained model, just run main.py file)

[//]: # ()
[//]: # (Set )

[//]: # (1. Comment out the call to main&#40;&#41; on line 270.)

[//]: # (2. Uncomment the call to my_test&#40;&#41; on line 273.)

[//]: # ()
[//]: # (After making these changes, run the main.py script to test the trained model.)

[//]: # (```shell)

[//]: # (python main.py --experiment_idx 1 --model_idx 200)

[//]: # (```)

[//]: # (If you want to)
### Note:
We are unable to publicly share the flow data of **Shenzhen** required for this project. In order to ensure smooth execution and allow you to explore the functionality, you can generate a flow.npy file of size 74x74 on your own.

If you wish to conduct tests or experiments, we provide the following sample code to help you generate a synthetic flow.npy file:

```python
import numpy as np

# Generate a random 74x74 array
flow_data = np.random.random((74, 74))

# Normalize the rows to sum up to 1
flow_data_normalized = flow_data / np.sum(flow_data, axis=1, keepdims=True)

# Save it as flow.npy file
np.save('flow.npy', flow_data_normalized)
```
Please note that this is just an example, and the generated data is random.


However, we provide the mobility networks of **NYC and Tokyo**, which are generated by gravity model.